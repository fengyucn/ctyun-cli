# 版本号管理文档

## 概述

本文档记录了项目中所有包含版本号的文件位置和格式，便于版本发布时快速更新。

## 当前版本号

**当前版本**: `1.3.10`
**版本格式**: `主版本.次版本.修订版本` (遵循语义化版本控制)

## 版本号文件列表

### 🔧 核心配置文件 (必须更新)

| 文件路径 | 行号 | 格式 | 更新命令 |
|---------|------|------|----------|
| `pyproject.toml` | 7 | `version = "1.3.10"` | `sed -i 's/version = ".*"/version = "1.3.10"/' pyproject.toml` |
| `setup.py` | 48 | `version="1.3.10",` | `sed -i 's/version=".*",/version="1.3.10",/' setup.py` |
| `src/ctyun_cli/__init__.py` | 5 | `__version__ = "1.3.10"` | `sed -i 's/__version__ = ".*"/__version__ = "1.3.10"/' src/ctyun_cli/__init__.py` |

### 📚 主要文档 (需要更新)

| 文件路径 | 行号 | 格式 | 说明 |
|---------|------|------|------|
| `README.md` | 302 | `**当前版本：** 1.3.10 (Latest)` | 中文主文档 |
| `README_EN.md` | 276 | `**Current Version:** 1.3.10` | 英文主文档 |
| `REDIS_CREATE_INSTANCE.md` | 209 | `- **CLI版本**: v1.3.10+` | Redis功能文档 |
| `PROJECT_RULES.md` | 7 | `**当前版本：** v1.3.10` | 项目规则文档 |
| `PROJECT_SUMMARY.md` | 16 | `**当前版本**: 1.3.10` | 项目总结文档 |

### 📝 特殊处理文件

| 文件路径 | 说明 | 处理方式 |
|---------|------|----------|
| `README.md` | 包含版本历史记录 | 需要添加新版本更新说明，保留历史版本 |
| `PROJECT_RULES.md` | 包含适用版本说明 | 更新两处版本号 |
| `PROJECT_SUMMARY.md` | 包含版本说明 | 更新两处版本号 |

## 版本更新流程

### 🚀 快速更新 (推荐)

使用自动化脚本一键更新所有版本号：

```bash
# 更新到新版本
./update_version.sh 1.3.11

# 脚本会自动:
# 1. 创建备份
# 2. 更新所有核心配置文件
# 3. 更新所有文档
# 4. 验证更新结果
# 5. 检查遗漏的版本引用
```

### 📝 手动更新

#### 1. 确定版本号
- **功能增强**: 修订版本号 +1 (例如: 1.3.9 → 1.3.10)
- **新功能**: 次版本号 +1 (例如: 1.3.10 → 1.4.0)
- **重大变更**: 主版本号 +1 (例如: 1.3.10 → 2.0.0)

### 2. 批量更新版本号

#### 方法一: 使用 sed 命令 (推荐)
```bash
# 设置新版本号
NEW_VERSION="1.3.10"

# 更新核心配置文件
sed -i "s/version = \".*\"/version = \"$NEW_VERSION\"/" pyproject.toml
sed -i "s/version=\".*\",/version=\"$NEW_VERSION\",/" setup.py
sed -i "s/__version__ = \".*\"/__version__ = \"$NEW_VERSION\"/" src/ctyun_cli/__init__.py

# 更新文档 (注意格式差异)
sed -i "s/\*\*当前版本：\** \([0-9.]\+\) (Latest)/**当前版本：** $NEW_VERSION (Latest)/" README.md
sed -i "s/\*\*Current Version:\*\* \([0-9.]\+\)/**Current Version:** $NEW_VERSION/" README_EN.md
```

#### 方法二: 手动更新
按照上表逐个文件进行更新

### 3. 更新版本说明
在 `README.md` 中添加新版本的更新说明：

```markdown
**重大更新 v1.3.10 - 功能名称：**

- 🔥 **新功能描述1** - 详细说明
- ✨ **新功能描述2** - 详细说明
- 🔧 **改进说明3** - 详细说明
```

### 4. 验证版本一致性
```bash
# 验证核心文件版本号
echo "=== 核心文件版本 ==="
grep "version = " pyproject.toml
grep "version=" setup.py
grep "__version__" src/ctyun_cli/__init__.py

# 验证文档版本号
echo "=== 文档版本 ==="
grep "当前版本：" README.md
grep "Current Version:" README_EN.md
```

## 版本发布检查清单

### ✅ 发布前检查
- [ ] 所有核心配置文件版本号已更新
- [ ] 所有文档版本号已更新
- [ ] README.md 中添加了新版本说明
- [ ] 版本号格式一致
- [ ] 没有遗漏的版本引用

### ✅ 发布后验证
- [ ] `python -m build` 构建成功
- [ ] `pip install -e .` 安装测试成功
- [ ] `ctyun-cli --version` 显示正确版本号
- [ ] 所有功能正常工作

## 历史版本记录

| 版本号 | 发布日期 | 主要变更 |
|--------|----------|----------|
| 1.3.10 | 2025-11-28 | 新增IAM分页查询资源信息API，增强资源字段显示 |
| 1.3.9 | 2025-11-27 | Redis功能全面升级，支持完整25+API参数 |
| 1.3.8 | - | - |

## 快速查找命令

```bash
# 查找所有包含版本号的文件
grep -r "1\.3\." . --include="*.py" --include="*.md" --include="*.toml" --include="*.txt" -n

# 查找特定文件中的版本号
grep -n "version\|Version" README.md

# 排除历史版本，只查找当前版本引用
grep -r "当前版本\|Current Version" . --include="*.md" -n
```

## 注意事项

1. **版本格式一致性**: 确保所有文件使用相同的版本格式
2. **历史版本保留**: README.md 中的历史版本记录不应删除
3. **文档同步**: 中文和英文文档需要同步更新
4. **构建验证**: 版本更新后必须进行构建测试
5. **Git提交**: 记得将版本号更新提交到版本控制系统

---

## 🛠️ 相关工具文件

| 文件名 | 说明 | 用途 |
|--------|------|------|
| `VERSION_FILES.md` | 本文档 | 版本号管理和记录 |
| `update_version.sh` | 自动化脚本 | 一键更新所有版本号 |

---

**文档更新时间**: 2025-11-28
**当前版本**: 1.3.10
**维护责任**: 项目维护者