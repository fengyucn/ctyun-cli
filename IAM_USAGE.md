# å¤©ç¿¼äº‘IAMï¼ˆç»Ÿä¸€èº«ä»½è®¤è¯ï¼‰APIä½¿ç”¨æŒ‡å—

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

IAMæ¨¡å—æä¾›ä¼ä¸šé¡¹ç›®ç®¡ç†åŠŸèƒ½ï¼Œæ”¯æŒï¼š
- æŸ¥è¯¢ä¼ä¸šé¡¹ç›®åˆ—è¡¨
- æŸ¥è¯¢ä¼ä¸šé¡¹ç›®è¯¦æƒ…

## ğŸ”§ APIç»ˆç«¯èŠ‚ç‚¹

```
ctiam-global.ctapi.ctyun.cn
```

## ğŸ“š å¯ç”¨å‘½ä»¤

### 1. æŸ¥è¯¢ä¼ä¸šé¡¹ç›®åˆ—è¡¨

**å‘½ä»¤**ï¼š
```bash
ctyun-cli iam list-projects --account-id <è´¦å·ID> [é€‰é¡¹]
```

**å‚æ•°è¯´æ˜**ï¼š
- `--account-id`: è´¦å·IDï¼ˆå¿…éœ€ï¼‰âš ï¸ **æ³¨æ„ï¼šè¿™ä¸æ˜¯Access Keyï¼Œè€Œæ˜¯çœŸå®çš„è´¦å·ID**
- `--page`: å½“å‰é¡µï¼Œé»˜è®¤1
- `--page-size`: æ¯é¡µæ˜¾ç¤ºæ¡æ•°ï¼Œé»˜è®¤10
- `--output`: è¾“å‡ºæ ¼å¼ï¼ˆtable/json/yamlï¼‰

**ç¤ºä¾‹**ï¼š
```bash
# æŸ¥è¯¢ä¼ä¸šé¡¹ç›®åˆ—è¡¨ï¼ˆç¬¬1é¡µï¼Œæ¯é¡µ10æ¡ï¼‰
ctyun-cli iam list-projects \
  --account-id 790251264ec0480e91b9b17 \
  --page 1 \
  --page-size 10

# ä»¥JSONæ ¼å¼è¾“å‡º
ctyun-cli iam list-projects \
  --account-id 790251264ec0480e91b9b17 \
  --output json
```

**è¿”å›ç»“æœ**ï¼š
```
ä¼ä¸šé¡¹ç›®åˆ—è¡¨ (æ€»è®¡: 1 ä¸ª, ç¬¬1/1é¡µ)

+----------+-------------+------+---------+---------------------+
| é¡¹ç›®ID    | é¡¹ç›®åç§°      | çŠ¶æ€  | æè¿°     | åˆ›å»ºæ—¶é—´             |
+==========+=============+======+=========+=====================+
| 0        | default     | å¯ç”¨  | é»˜è®¤... | 2021-12-22 06:31:11 |
+----------+-------------+------+---------+---------------------+
```

### 2. æŸ¥è¯¢ä¼ä¸šé¡¹ç›®è¯¦æƒ…

**å‘½ä»¤**ï¼š
```bash
ctyun-cli iam get-project --project-id <ä¼ä¸šé¡¹ç›®ID> [é€‰é¡¹]
```

**å‚æ•°è¯´æ˜**ï¼š
- `--project-id`: ä¼ä¸šé¡¹ç›®IDï¼ˆå¿…éœ€ï¼‰
- `--output`: è¾“å‡ºæ ¼å¼ï¼ˆtable/json/yamlï¼‰

**ç¤ºä¾‹**ï¼š
```bash
# æŸ¥è¯¢IDä¸º0çš„ä¼ä¸šé¡¹ç›®è¯¦æƒ…
ctyun-cli iam get-project --project-id 0

# ä»¥JSONæ ¼å¼è¾“å‡º
ctyun-cli iam get-project --project-id 0 --output json
```

**è¿”å›ç»“æœ**ï¼š
```
ä¼ä¸šé¡¹ç›®è¯¦æƒ…
================================================================================
é¡¹ç›®ID: 0
é¡¹ç›®åç§°: default
çŠ¶æ€: å¯ç”¨
åä¸ºé¡¹ç›®ID: 0
æè¿°: é»˜è®¤ä¼ä¸šé¡¹ç›®ï¼Œè´¦å·ä¸‹åŸæœ‰èµ„æºå’Œæœªé€‰æ‹©ä¼ä¸šé¡¹ç›®çš„èµ„æºå‡åœ¨é»˜è®¤ä¼ä¸šé¡¹ç›®å†…ã€‚
åˆ›å»ºæ—¶é—´: 2021-12-22 06:31:11
================================================================================
```

## âš ï¸  é‡è¦è¯´æ˜

### å…³äºè´¦å·ID (accountId)

**è´¦å·ID â‰  Access Key**

- `accountId` æ˜¯æ‚¨çš„å¤©ç¿¼äº‘è´¦å·çš„å”¯ä¸€æ ‡è¯†ç¬¦
- é€šå¸¸æ˜¯ä¸€ä¸ªç±»ä¼¼ `790251264ec0480e91b9b17` çš„å­—ç¬¦ä¸²
- å¯ä»¥ä»ä»¥ä¸‹é€”å¾„è·å–ï¼š
  1. å¤©ç¿¼äº‘æ§åˆ¶å° â†’ è´¦å·ä¸­å¿ƒ â†’ è´¦å·ä¿¡æ¯
  2. è”ç³»å¤©ç¿¼äº‘å®¢æœè·å–
  3. é€šè¿‡å…¶ä»–APIçš„å“åº”ä¸­è·å–

### è®¤è¯æœºåˆ¶

IAM APIä½¿ç”¨EOPç­¾åè®¤è¯ï¼Œéœ€è¦åŒæ—¶æ»¡è¶³ï¼š
1. è¯·æ±‚å¤´ä¸­çš„ `accountId` å­—æ®µ
2. è¯·æ±‚ä½“ä¸­çš„ `accountId` å‚æ•°
3. ä¸¤è€…å¿…é¡»ä¸€è‡´ï¼Œå¦åˆ™ä¼šè¿”å›é”™è¯¯ï¼š`CTIAM_0113: è¯·æ±‚å¤´è´¦å·IDä¸è¯·æ±‚å‚æ•°è´¦å·IDä¸åŒ`

## ğŸ” è°ƒè¯•æ¨¡å¼

å¯ç”¨è°ƒè¯•æ¨¡å¼æŸ¥çœ‹è¯¦ç»†è¯·æ±‚ä¿¡æ¯ï¼š

```bash
ctyun-cli --debug iam list-projects --account-id <è´¦å·ID>
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
2025-11-19 09:47:53,383 - ctyun_cli - DEBUG - è¯·æ±‚URL: https://ctiam-global.ctapi.ctyun.cn/v1/project/getEpPageList
2025-11-19 09:47:53,383 - ctyun_cli - DEBUG - è¯·æ±‚ä½“: {"accountId": "...", "currentPage": 1, "pageSize": 10}
2025-11-19 09:47:53,383 - ctyun_cli - DEBUG - è¯·æ±‚å¤´: {'Content-Type': 'application/json', ...}
```

## ğŸ“– APIå‚è€ƒ

### ä¼ä¸šé¡¹ç›®åˆ—è¡¨å“åº”ç»“æ„

```json
{
  "statusCode": "800",
  "returnObj": {
    "currentPage": 1,
    "pageSize": 10,
    "recordCount": 1,
    "pageCount": 1,
    "beginPageIndex": 1,
    "endPageIndex": 1,
    "recordList": [
      {
        "id": "0",
        "projectName": "default",
        "status": 1,
        "hwProjectId": "0",
        "description": "é»˜è®¤ä¼ä¸šé¡¹ç›®ï¼Œè´¦å·ä¸‹åŸæœ‰èµ„æºå’Œæœªé€‰æ‹©ä¼ä¸šé¡¹ç›®çš„èµ„æºå‡åœ¨é»˜è®¤ä¼ä¸šé¡¹ç›®å†…ã€‚",
        "createTime": 1640135871000,
        "updateTime": null,
        "accountId": "790251264ec0480e91b9b17"
      }
    ]
  }
}
```

### ä¼ä¸šé¡¹ç›®è¯¦æƒ…å“åº”ç»“æ„

```json
{
  "statusCode": "800",
  "returnObj": {
    "id": "0",
    "projectName": "default",
    "status": 1,
    "hwProjectId": "0",
    "description": "é»˜è®¤ä¼ä¸šé¡¹ç›®ï¼Œè´¦å·ä¸‹åŸæœ‰èµ„æºå’Œæœªé€‰æ‹©ä¼ä¸šé¡¹ç›®çš„èµ„æºå‡åœ¨é»˜è®¤ä¼ä¸šé¡¹ç›®å†…ã€‚",
    "createTime": 1640135871000
  }
}
```

## ğŸ¯ å¸¸è§é”™è¯¯

| é”™è¯¯ç  | é”™è¯¯ä¿¡æ¯ | è§£å†³æ–¹æ¡ˆ |
|--------|---------|---------|
| CTIAM_0113 | è¯·æ±‚å¤´è´¦å·IDä¸è¯·æ±‚å‚æ•°è´¦å·IDä¸åŒ | ç¡®ä¿ä½¿ç”¨çš„æ˜¯æ­£ç¡®çš„è´¦å·IDï¼Œè€Œä¸æ˜¯Access Key |
| HTTP_401 | è®¤è¯å¤±è´¥ | æ£€æŸ¥Access Keyå’ŒSecret Keyæ˜¯å¦æ­£ç¡®é…ç½® |
| HTTP_403 | æƒé™ä¸è¶³ | ç¡®è®¤è´¦å·æ˜¯å¦æœ‰æŸ¥è¯¢ä¼ä¸šé¡¹ç›®çš„æƒé™ |

## ğŸ”— ç›¸å…³å‘½ä»¤

```bash
# æŸ¥çœ‹æ‰€æœ‰IAMå‘½ä»¤
ctyun-cli iam --help

# æŸ¥çœ‹list-projectså‘½ä»¤å¸®åŠ©
ctyun-cli iam list-projects --help

# æŸ¥çœ‹get-projectå‘½ä»¤å¸®åŠ©
ctyun-cli iam get-project --help
```
